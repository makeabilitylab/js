function t(t){return t*(Math.PI/180)}function e(t){return t*(180/Math.PI)}function i(t,e,i){return(1-i)*t+i*e}function s(t,e){void 0===e&&(e=t,t=0);const i=Math.min(t,e),s=Math.max(t,e);return Math.random()*(s-i)+i}function r(t=0,e=1){const i=Math.random(),s=Math.random();return Math.sqrt(-2*Math.log(i))*Math.cos(2*Math.PI*s)*e+t}function l(t){return 1-Math.pow(1-t,3)}class o{constructor(t,e){this.x=t,this.y=e}add(t){return new o(this.x+t.x,this.y+t.y)}subtract(t){return new o(this.x-t.x,this.y-t.y)}multiply(t){return new o(this.x*t,this.y*t)}divide(t){return new o(this.x/t,this.y/t)}magnitude(){return Math.sqrt(this.x*this.x+this.y*this.y)}normalize(){const t=this.magnitude();return 0===t?new o(0,0):new o(this.x/t,this.y/t)}dotProduct(t){return this.x*t.x+this.y*t.y}angleBetween(t){const e=this.dotProduct(t),i=this.magnitude()*t.magnitude();if(Math.abs(e-i)<Number.EPSILON)return e>=0?0:Math.PI;if(0===i)return 0;const s=e/i;let r=Math.acos(s);return this.x*t.y-this.y*t.x<0&&(r=2*Math.PI-r),r}toString(){return`(${this.x}, ${this.y})`}static fromPoints(t,e){return new o(e.x-t.x,e.y-t.y)}}function a(t,e,s){t=h(t),e=h(e);const r=(t,e,i)=>Math.min(i,Math.max(e,t));return`rgba(${r(Math.round(i(t.r,e.r,s)),0,255)}, ${r(Math.round(i(t.g,e.g,s)),0,255)}, ${r(Math.round(i(t.b,e.b,s)),0,255)}, ${r(i(t.a??1,e.a??1,s),0,1)})`}function h(t){if("string"==typeof t){if(c[t.toLowerCase()])return c[t.toLowerCase()];const e=t.match(/^#([0-9a-fA-F]{6}|[0-9a-fA-F]{3}|[0-9a-fA-F]{8})$/);if(e){const t=e[1];return 8===t.length?{r:parseInt(t.substring(0,2),16),g:parseInt(t.substring(2,4),16),b:parseInt(t.substring(4,6),16),a:parseInt(t.substring(6,8),16)/255}:{r:parseInt(t.substring(0,2),16),g:parseInt(t.substring(2,4),16),b:parseInt(t.substring(4,6),16),a:1}}if(t.startsWith("rgb")){const e=t.match(/rgba?\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?\)/);if(e){const[,t,i,s,r]=e,l=t=>Math.min(255,Math.max(0,parseInt(t)));return{r:l(t),g:l(i),b:l(s),a:void 0!==r?parseFloat(r):1}}}throw new Error(`Invalid color string: ${t}`)}return t}function n(t,e,i,s=!0){let r,l,o;const a=Math.floor(6*t),h=6*t-a,n=i*(1-e),g=i*(1-h*e),c=i*(1-(1-h)*e);switch(a%6){case 0:r=i,l=c,o=n;break;case 1:r=g,l=i,o=n;break;case 2:r=n,l=i,o=c;break;case 3:r=n,l=g,o=i;break;case 4:r=c,l=n,o=i;break;case 5:r=i,l=n,o=g}return s?{r:Math.round(255*r),g:Math.round(255*l),b:Math.round(255*o)}:{r:255*r,g:255*l,b:255*o}}function g(t,e,i){const s=Math.max(t,e,i),r=Math.min(t,e,i),l=s-r;let o;const a=0===s?0:l/s,h=s/255;switch(s){case r:o=0;break;case t:o=e-i+l*(e<i?6:0),o/=6*l;break;case e:o=i-t+2*l,o/=6*l;break;case i:o=t-e+4*l,o/=6*l}return{h:o,s:a,v:h}}const c={aliceblue:{r:240,g:248,b:255,a:1},antiquewhite:{r:250,g:235,b:215,a:1},aqua:{r:0,g:255,b:255,a:1},aquamarine:{r:127,g:255,b:212,a:1},azure:{r:240,g:255,b:255,a:1},beige:{r:245,g:245,b:220,a:1},bisque:{r:255,g:228,b:196,a:1},black:{r:0,g:0,b:0,a:1},blanchedalmond:{r:255,g:235,b:205,a:1},blue:{r:0,g:0,b:255,a:1},blueviolet:{r:138,g:43,b:226,a:1},brown:{r:165,g:42,b:42,a:1},burlywood:{r:222,g:184,b:135,a:1},cadetblue:{r:95,g:158,b:160,a:1},chartreuse:{r:127,g:255,b:0,a:1},chocolate:{r:210,g:105,b:30,a:1},coral:{r:255,g:127,b:80,a:1},cornflowerblue:{r:100,g:149,b:237,a:1},cornsilk:{r:255,g:248,b:220,a:1},crimson:{r:220,g:20,b:60,a:1},cyan:{r:0,g:255,b:255,a:1},darkblue:{r:0,g:0,b:139,a:1},darkcyan:{r:0,g:139,b:139,a:1},darkgoldenrod:{r:184,g:134,b:11,a:1},darkgray:{r:169,g:169,b:169,a:1},darkgreen:{r:0,g:100,b:0,a:1},darkkhaki:{r:189,g:183,b:107,a:1},darkmagenta:{r:139,g:0,b:139,a:1},darkolivegreen:{r:85,g:107,b:47,a:1},darkorange:{r:255,g:140,b:0,a:1},darkorchid:{r:153,g:50,b:204,a:1},darkred:{r:139,g:0,b:0,a:1},darksalmon:{r:233,g:150,b:122,a:1},darkseagreen:{r:143,g:188,b:143,a:1},darkslateblue:{r:72,g:61,b:139,a:1},darkslategray:{r:47,g:79,b:79,a:1},darkturquoise:{r:0,g:206,b:209,a:1},darkviolet:{r:148,g:0,b:211,a:1},deeppink:{r:255,g:20,b:147,a:1},deepskyblue:{r:0,g:191,b:255,a:1},dimgray:{r:105,g:105,b:105,a:1},dodgerblue:{r:30,g:144,b:255,a:1},firebrick:{r:178,g:34,b:34,a:1},floralwhite:{r:255,g:250,b:240,a:1},forestgreen:{r:34,g:139,b:34,a:1},fuchsia:{r:255,g:0,b:255,a:1},gainsboro:{r:220,g:220,b:220,a:1},ghostwhite:{r:248,g:248,b:255,a:1},gold:{r:255,g:215,b:0,a:1},goldenrod:{r:218,g:165,b:32,a:1},gray:{r:128,g:128,b:128,a:1},green:{r:0,g:128,b:0,a:1},greenyellow:{r:173,g:255,b:47,a:1},honeydew:{r:240,g:255,b:240,a:1},hotpink:{r:255,g:105,b:180,a:1},indianred:{r:205,g:92,b:92,a:1},indigo:{r:75,g:0,b:130,a:1},ivory:{r:255,g:255,b:240,a:1},khaki:{r:240,g:230,b:140,a:1},lavender:{r:230,g:230,b:250,a:1},lavenderblush:{r:255,g:240,b:245,a:1},lawngreen:{r:124,g:252,b:0,a:1},lemonchiffon:{r:255,g:250,b:205,a:1},lightblue:{r:173,g:216,b:230,a:1},lightcoral:{r:240,g:128,b:128,a:1},lightcyan:{r:224,g:255,b:255,a:1},lightgoldenrodyellow:{r:250,g:250,b:210,a:1},lightgray:{r:211,g:211,b:211,a:1},lightgreen:{r:144,g:238,b:144,a:1},lightpink:{r:255,g:182,b:193,a:1},lightsalmon:{r:255,g:160,b:122,a:1},lightseagreen:{r:32,g:178,b:170,a:1},lightskyblue:{r:135,g:206,b:250,a:1},lightslategray:{r:119,g:136,b:153,a:1},lightsteelblue:{r:176,g:196,b:222,a:1},lightyellow:{r:255,g:255,b:224,a:1},lime:{r:0,g:255,b:0,a:1},limegreen:{r:50,g:205,b:50,a:1},linen:{r:250,g:240,b:230,a:1},magenta:{r:255,g:0,b:255,a:1},maroon:{r:128,g:0,b:0,a:1},mediumaquamarine:{r:102,g:205,b:170,a:1},mediumblue:{r:0,g:0,b:205,a:1},mediumorchid:{r:186,g:85,b:211,a:1},mediumpurple:{r:147,g:112,b:219,a:1},mediumseagreen:{r:60,g:179,b:113,a:1},mediumslateblue:{r:123,g:104,b:238,a:1},mediumspringgreen:{r:0,g:250,b:154,a:1},mediumturquoise:{r:72,g:209,b:204,a:1},mediumvioletred:{r:199,g:21,b:133,a:1},midnightblue:{r:25,g:25,b:112,a:1},mintcream:{r:245,g:255,b:250,a:1},mistyrose:{r:255,g:228,b:225,a:1},moccasin:{r:255,g:228,b:181,a:1},navajowhite:{r:255,g:222,b:173,a:1},navy:{r:0,g:0,b:128,a:1},oldlace:{r:253,g:245,b:230,a:1},olive:{r:128,g:128,b:0,a:1},olivedrab:{r:107,g:142,b:35,a:1},orange:{r:255,g:165,b:0,a:1},orangered:{r:255,g:69,b:0,a:1},orchid:{r:218,g:112,b:214,a:1},palegoldenrod:{r:238,g:232,b:170,a:1},palegreen:{r:152,g:251,b:152,a:1},paleturquoise:{r:175,g:238,b:238,a:1},palevioletred:{r:219,g:112,b:147,a:1},papayawhip:{r:255,g:239,b:213,a:1},peachpuff:{r:255,g:218,b:185,a:1},peru:{r:205,g:133,b:63,a:1},pink:{r:255,g:192,b:203,a:1},plum:{r:221,g:160,b:221,a:1},powderblue:{r:176,g:224,b:230,a:1},purple:{r:128,g:0,b:128,a:1},rebeccapurple:{r:102,g:51,b:153,a:1},red:{r:255,g:0,b:0,a:1},rosybrown:{r:188,g:143,b:143,a:1},royalblue:{r:65,g:105,b:225,a:1},saddlebrown:{r:139,g:69,b:19,a:1},salmon:{r:250,g:128,b:114,a:1},sandybrown:{r:244,g:164,b:96,a:1},seagreen:{r:46,g:139,b:87,a:1},seashell:{r:255,g:245,b:238,a:1},sienna:{r:160,g:82,b:45,a:1},silver:{r:192,g:192,b:192,a:1},skyblue:{r:135,g:206,b:235,a:1},slateblue:{r:106,g:90,b:205,a:1},slategray:{r:112,g:128,b:144,a:1},snow:{r:255,g:250,b:250,a:1},springgreen:{r:0,g:255,b:127,a:1},steelblue:{r:70,g:130,b:180,a:1},tan:{r:210,g:180,b:140,a:1},teal:{r:0,g:128,b:128,a:1},thistle:{r:216,g:191,b:216,a:1},tomato:{r:255,g:99,b:71,a:1},turquoise:{r:64,g:224,b:208,a:1},violet:{r:238,g:130,b:238,a:1},wheat:{r:245,g:222,b:179,a:1},white:{r:255,g:255,b:255,a:1},whitesmoke:{r:245,g:245,b:245,a:1},yellow:{r:255,g:255,b:0,a:1},yellowgreen:{r:154,g:205,b:50,a:1}};class b{constructor(t,e,i,s){2==arguments.length&&"object"==typeof t&&"object"==typeof e?(this.pt1=t,this.pt2=e):(this.pt1=new o(t,e),this.pt2=new o(i,s)),this.fontSize=10,this.strokeColor="black",this.isDashedLine=!1,this.drawTextLabels=!0,this.drawTextMagnitude=!0,this.drawTextAngle=!0,this.strokeWeight=2}get x1(){return this.pt1.x}set x1(t){this.pt1.x=t}get y1(){return this.pt1.y}set y1(t){this.pt1.y=t}get x2(){return this.pt2.x}set x2(t){this.pt2.x=t}get y2(){return this.pt2.y}set y2(t){this.pt2.y=t}getHeading(){const t=this.pt2.subtract(this.pt1);let e=Math.atan2(t.y,t.x);return e<0&&(e+=2*Math.PI),e}getNormals(){return function(t,e){const i=e.subtract(t);return[new o(i.y,-i.x),new o(-i.y,i.x)]}(this.pt1,this.pt2)}getNormal(){return this.getNormals()[0]}getVectorAtOrigin(){return this.pt2.subtract(this.pt1)}getAnglesBetween(t){const i=this.getVectorAtOrigin();let s;s=t instanceof b?t.getVectorAtOrigin():t;let r=i.angleBetween(s);console.log(`angleBetweenDegrees: ${e(r).toFixed(1)}`),r<0&&(r+=2*Math.PI);const l=r;return{counterclockwiseAngle:2*Math.PI-r,clockwiseAngle:l}}getOrthogonalProjection(t){const e=this.pt2.subtract(this.pt1),i=t.subtract(this.pt1),s=e.magnitude(),r=Math.min(Math.max(i.dotProduct(e.normalize()),0),s);return this.pt1.add(e.normalize().multiply(r))}getDistance(t){const e=this.getOrthogonalProjection(t);return t.subtract(e).magnitude()}getMagnitude(){return this.pt2.subtract(this.pt1).magnitude()}setMagnitude(t){const e=this.pt2.subtract(this.pt1).normalize().multiply(t);this.pt2=this.pt1.add(e)}draw(t){if(t.strokeStyle=this.strokeColor,t.lineWidth=this.strokeWeight,this.isDashedLine&&t.setLineDash([5,15]),this.drawArrow(t,this.pt1,this.pt2.subtract(this.pt1),this.strokeColor),this.drawTextLabels){t.save(),t.font=`${this.fontSize}px Arial`,t.textAlign="left",t.textBaseline="top",t.fillStyle=this.strokeColor;const e=this.generateLabel(),i=t.measureText(e).width;t.fillText(e,this.pt1.x-i-3,this.pt1.y+12),t.restore()}}drawArrow(t,e,i,s){const r=10,l=Math.atan2(i.y,i.x);t.save(),t.strokeStyle=s,t.fillStyle=s,t.beginPath(),t.moveTo(e.x,e.y),t.lineTo(e.x+i.x,e.y+i.y),t.stroke(),t.beginPath(),t.moveTo(e.x+i.x,e.y+i.y),t.lineTo(e.x+i.x-r*Math.cos(l-Math.PI/6),e.y+i.y-r*Math.sin(l-Math.PI/6)),t.lineTo(e.x+i.x-r*Math.cos(l+Math.PI/6),e.y+i.y-r*Math.sin(l+Math.PI/6)),t.lineTo(e.x+i.x,e.y+i.y),t.lineTo(e.x+i.x-r*Math.cos(l-Math.PI/6),e.y+i.y-r*Math.sin(l-Math.PI/6)),t.stroke(),t.fill(),t.restore()}generateLabel(){let t="";if(this.drawTextAngle){t+=`${Math.round(180*Math.atan2(this.pt2.y-this.pt1.y,this.pt2.x-this.pt1.x)/Math.PI)}°`}return this.drawTextAngle&&this.drawTextMagnitude&&(t+=" "),this.drawTextMagnitude&&(t+=`|${this.getMagnitude().toFixed(1)}|`),t}static drawAngleArcs(t,i,s,r="blue",l="red",a=50,h=30){const n=i.getHeading(),g=i.getAnglesBetween(s);console.log(`CW angle ${e(g.clockwiseAngle).toFixed(1)} CCW angle ${e(g.counterclockwiseAngle).toFixed(1)}`),t.save(),t.beginPath(),t.arc(i.pt1.x,i.pt1.y,a,n,n+g.clockwiseAngle,!1),t.strokeStyle=r,t.stroke();const c=new o(i.pt1.x+1.35*a*Math.cos(n+g.clockwiseAngle/2),i.pt1.y+1.35*a*Math.sin(n+g.clockwiseAngle/2));t.font="12px Arial",t.textAlign="center",t.textBaseline="middle",t.fillStyle=r;const b=`${e(g.clockwiseAngle).toFixed(1)}°`;t.fillText(b,c.x,c.y),t.beginPath(),t.arc(i.pt1.x,i.pt1.y,h,n,n-g.counterclockwiseAngle,!0),t.strokeStyle=l,t.stroke();const u=new o(i.pt1.x+1.5*h*Math.cos(n-g.counterclockwiseAngle/2),i.pt1.y+1.5*h*Math.sin(n-g.counterclockwiseAngle/2)),d=`${e(g.counterclockwiseAngle).toFixed(1)}°`;t.fillStyle=l,t.fillText(d,u.x,u.y),t.restore()}}class u{static get DEFAULT_M_OUTLINE_COLOR(){return"black"}static get DEFAULT_M_OUTLINE_STROKE_WIDTH(){return 4}static get DEFAULT_L_OUTLINE_COLOR(){return"black"}static get DEFAULT_L_OUTLINE_STROKE_WIDTH(){return 4}constructor(t,e,i){this.makeLabLogoArray=u.createMakeabilityLabLogoCellArray(t,e,i),this.visible=!0,this.isMOutlineVisible=!0,this.isLOutlineVisible=!0,this.mOutlineColor=u.DEFAULT_M_OUTLINE_COLOR,this.mOutlineStrokeWidth=u.DEFAULT_M_OUTLINE_STROKE_WIDTH,this.lOutlineColor=u.DEFAULT_L_OUTLINE_COLOR,this.lOutlineStrokeWidth=u.DEFAULT_L_OUTLINE_STROKE_WIDTH,this.setColors("white","black"),this.setFillColorsToDefault();for(const t of this.getMShadowTriangles())t.fillColor=t.strokeColor;this.areLTriangleStrokesVisible=!1,this.drawBoundingBox=!1,this.lOutlineOpacity=1,this.mOutlineOpacity=1,this.isLabelVisible=!1,this.labelText="MAKEABILITY LAB",this.labelBoldUntilIndex=4,this.labelFontFamily="Inter, Roboto, system-ui, -apple-system, sans-serif",this.labelColor="black",this.labelGap=8,this.labelFontSizeFraction=.09}static get numRows(){return 4}static get numCols(){return 6}static getGridWidth(t){return u.numCols*t}static getGridHeight(t){return u.numRows*t}static getGridXCenterPosition(t,e,i=!1,s=0){const r=(e-u.getGridWidth(t)-s)/2;return i?Math.round(r/t)*t:r}static getGridYCenterPosition(t,e,i=!1,s=0){const r=(e-u.getGridHeight(t)-s)/2;return i?Math.round(r/t)*t:r}setDrawDebugInfo(t){this.drawBoundingBox=t;for(let e=0;e<this.makeLabLogoArray.length;e++)for(let i=0;i<this.makeLabLogoArray[e].length;i++)this.makeLabLogoArray[e][i].setDrawDebugInfo(t)}getBoundingBox(){let t=1/0,e=1/0,i=-1/0,s=-1/0,r=null,l=null,o=null,a=null;for(const h of this.getAllTriangles()){if(!h.visible)continue;const n=h.getBoundingBox();n.x<t&&(t=n.x,r=h),n.y<e&&(e=n.y,l=h),n.x+n.width>i&&(i=n.x+n.width,o=h),n.y+n.height>s&&(s=n.y+n.height,a=h)}const h=Math.max(this.mOutlineStrokeWidth,this.lOutlineStrokeWidth)/2;return{x:t-h,y:e-h,width:i-t+2*h,height:s-e+2*h+this.labelHeight,minXTriangle:r,minYTriangle:l,maxXTriangle:o,maxYTriangle:a}}get x(){return this.makeLabLogoArray[0][0].x}set x(t){const e=t-this.x;for(const t of this.getAllTriangles())t.x+=e}get y(){return this.makeLabLogoArray[0][0].y}set y(t){const e=t-this.y;for(const t of this.getAllTriangles())t.y+=e}get cellSize(){return this.makeLabLogoArray[0][0].size}get width(){return u.numCols*this.makeLabLogoArray[0][0].size}get logoGridHeight(){return u.numRows*this.makeLabLogoArray[0][0].size}get labelFontSize(){return this.width*this.labelFontSizeFraction}get labelHeight(){return this.isLabelVisible?this.labelGap+this.labelFontSize:0}get height(){return this.logoGridHeight+this.labelHeight}get areDefaultColorsOn(){return this._defaultColorsOn}fitToCanvas(t,e,i=!1){const s=Math.max(this.mOutlineStrokeWidth,this.lOutlineStrokeWidth);let r=t-s,l=e-s,o=u.numRows;this.isLabelVisible&&(l-=this.labelGap,o+=u.numCols*this.labelFontSizeFraction);const a=Math.min(r/u.numCols,l/o);this.setTriangleSize(a),this.centerLogo(t,e,i)}centerLogo(t,e,i=!1){const s=u.getGridXCenterPosition(this.cellSize,t,i);let r=(e-this.height)/2;i&&(r=Math.round(r/this.cellSize)*this.cellSize),this.setLogoPosition(s,r)}setLogoSize(t){const e=t/u.numCols;this.setTriangleSize(e)}setTriangleSize(t){const e=this.cellSize;if(e===t)return;const i=this.x,s=this.y;for(const r of this.getAllTriangles())r.x=i+(r.x-i)*(t/e),r.y=s+(r.y-s)*(t/e),r.size=t}setLogoPosition(t,e){const i=t-this.x,s=e-this.y;for(const t of this.getAllTriangles())t.x+=i,t.y+=s}set areLTriangleStrokesVisible(t){for(const e of this.getLTriangles())e.isStrokeVisible=t}get areLTriangleStrokesVisible(){return this.getLTriangles().every((t=>t.isStrokeVisible))}setLTriangleStrokeColor(t){for(const e of this.getLTriangles())e.strokeColor=t}setMShadowTriangleFillColor(t){for(const e of this.getMShadowTriangles())e.fillColor=t}setStrokeTransparent(t,e=!0){for(const i of this.getAllTriangles(e))i.isStrokeVisible=!t}setFillTransparent(t,e=!0){for(const i of this.getAllTriangles(e))i.isFillVisible=!t}setFillColor(t,e=!0){for(const i of this.getAllTriangles(e))i.fillColor=t}setColors(t,e,i=!0){for(const s of this.getAllTriangles(i))s.fillColor=t,s.strokeColor=e}getAllTriangles(t=!0,e=!0){let i=new Array;for(let s=0;s<this.makeLabLogoArray.length;s++)for(let r=0;r<this.makeLabLogoArray[s].length;r++)!t&&u.isMShadowTriangle(s,r,1)||!e&&u.isLTriangle(s,r,1)||i.push(this.makeLabLogoArray[s][r].tri1),!t&&u.isMShadowTriangle(s,r,2)||!e&&u.isLTriangle(s,r,2)||i.push(this.makeLabLogoArray[s][r].tri2);return i}getMShadowTriangles(){let t=new Array;return t.push(this.makeLabLogoArray[2][1].tri2),t.push(this.makeLabLogoArray[3][1].tri1),t.push(this.makeLabLogoArray[2][4].tri2),t.push(this.makeLabLogoArray[3][4].tri1),t}getLTriangles(){let t=new Array;return t.push(this.makeLabLogoArray[0][0].tri2),t.push(this.makeLabLogoArray[0][1].tri2),t.push(this.makeLabLogoArray[1][0].tri1),t.push(this.makeLabLogoArray[1][1].tri1),t.push(this.makeLabLogoArray[1][1].tri2),t.push(this.makeLabLogoArray[1][2].tri2),t.push(this.makeLabLogoArray[2][1].tri1),t.push(this.makeLabLogoArray[2][2].tri1),t.push(this.makeLabLogoArray[2][2].tri2),t.push(this.makeLabLogoArray[3][2].tri1),t.push(this.makeLabLogoArray[3][3].tri1),t.push(this.makeLabLogoArray[2][3].tri1),t.push(this.makeLabLogoArray[2][3].tri2),t.push(this.makeLabLogoArray[1][3].tri2),t.push(this.makeLabLogoArray[2][4].tri1),t.push(this.makeLabLogoArray[1][4].tri2),t}getDefaultColoredTriangles(){let t=new Array;return t.push(this.makeLabLogoArray[0][4].tri2),t.push(this.makeLabLogoArray[0][5].tri2),t.push(this.makeLabLogoArray[1][0].tri2),t.push(this.makeLabLogoArray[1][4].tri1),t.push(this.makeLabLogoArray[1][5].tri1),t.push(this.makeLabLogoArray[1][5].tri2),t.push(this.makeLabLogoArray[2][0].tri1),t.push(this.makeLabLogoArray[2][0].tri2),t.push(this.makeLabLogoArray[2][5].tri1),t.push(this.makeLabLogoArray[2][5].tri2),t.push(this.makeLabLogoArray[3][0].tri1),t.push(this.makeLabLogoArray[3][5].tri1),t}setFillColorsToDefault(){this.setDefaultColoredTrianglesFillColor(x),this._defaultColorsOn=!0}setDefaultColoredTrianglesFillColor(t){const e=this.getDefaultColoredTriangles();if(Array.isArray(t))for(let i=0;i<e.length;i++)e[i].fillColor=t[i];else for(let i=0;i<e.length;i++)e[i].fillColor=t}setStrokeWidth(t,e=!0,i=!0){for(const s of this.getAllTriangles(e,i))s.strokeWidth=t}draw(t){if(this.visible){if(this.drawBoundingBox){const e=this.getBoundingBox();t.save(),t.setLineDash([4,8]),t.strokeStyle="rgba(255, 0, 0, 0.5)",t.strokeRect(e.x,e.y,e.width,e.height),t.restore(),e.minXTriangle.visible=!0,e.maxXTriangle.visible=!0,e.minYTriangle.visible=!0,e.maxYTriangle.visible=!0,e.minXTriangle.fillColor="green",e.maxXTriangle.fillColor="blue",e.minYTriangle.fillColor="red",e.maxYTriangle.fillColor="orange",t.fillStyle="black",t.font="16px Arial";const i=`Bounding Box Dimensions: ${e.width.toFixed(1)} x ${e.height.toFixed(1)}`;t.textAlign="center",t.textBaseline="bottom",t.fillText(i,e.x+e.width/2,e.y);const s=`Width: ${e.width.toFixed(1)}`;t.textAlign="center",t.textBaseline="top",t.fillText(s,e.x+e.width/2,e.y+e.height+2);const r=`Height: ${e.height.toFixed(1)}`;t.save(),t.translate(e.x-1,e.y+e.height/2),t.rotate(-Math.PI/2),t.textAlign="center",t.textBaseline="bottom",t.fillText(r,0,0),t.restore()}for(let e=0;e<this.makeLabLogoArray.length;e++)for(let i=0;i<this.makeLabLogoArray[e].length;i++)this.makeLabLogoArray[e][i].draw(t);this.drawMOutline(t),this.drawLOutline(t),this.drawLabel(t)}}drawMOutline(t){if(this.isMOutlineVisible&&!(this.mOutlineOpacity<=0)){t.save(),t.globalAlpha=this.mOutlineOpacity,t.strokeStyle=this.mOutlineColor,t.lineWidth=this.mOutlineStrokeWidth,t.beginPath();for(const[e,i]of this.getMOutlinePoints())t.lineTo(e,i);t.closePath(),t.stroke(),t.restore()}}drawLOutline(t){if(this.isLOutlineVisible&&!(this.lOutlineOpacity<=0)){t.save(),t.globalAlpha=this.lOutlineOpacity,t.strokeStyle=this.lOutlineColor,t.lineWidth=this.lOutlineStrokeWidth,t.beginPath();for(const[e,i]of this.getLOutlinePoints())t.lineTo(e,i);t.closePath(),t.stroke(),t.restore()}}drawLabel(t,{opacity:e=1,yOffset:i=0}={}){if(!this.isLabelVisible||e<=0)return;const s=this.labelText.substring(0,this.labelBoldUntilIndex),r=this.labelText.substring(this.labelBoldUntilIndex);t.save(),t.font=`bold 100px ${this.labelFontFamily}`;const l=t.measureText(s).width;t.font=`100px ${this.labelFontFamily}`;const o=l+t.measureText(r).width,a=this.width/o*100,h=this.y+this.logoGridHeight+this.labelGap+a+i;t.globalAlpha=e,t.textBaseline="alphabetic",t.fillStyle=this.labelColor,t.font=`bold ${a}px ${this.labelFontFamily}`,t.textAlign="left",t.fillText(s,this.x,h);const n=t.measureText(s).width;t.font=`${a}px ${this.labelFontFamily}`,t.fillText(r,this.x+n,h),t.restore()}getLOutlineLineSegments(){let t=new Array;return t.push(new b(this.x+this.cellSize,this.y,this.x+3*this.cellSize,this.y+2*this.cellSize)),t.push(new b(this.x+3*this.cellSize,this.y+2*this.cellSize,this.x+4*this.cellSize,this.y+this.cellSize)),t.push(new b(this.x+4*this.cellSize,this.y+this.cellSize,this.x+5*this.cellSize,this.y+2*this.cellSize)),t.push(new b(this.x+5*this.cellSize,this.y+2*this.cellSize,this.x+3*this.cellSize,this.y+4*this.cellSize)),t.push(new b(this.x+3*this.cellSize,this.y+4*this.cellSize,this.x,this.y+1*this.cellSize)),t.push(new b(this.x,this.y+this.cellSize,this.x+this.cellSize,this.y)),t}getLOutlinePoints(){let t=new Array;return t.push([this.x,this.y+this.cellSize]),t.push([this.x+this.cellSize,this.y]),t.push([this.x+2*this.cellSize,this.y+this.cellSize]),t.push([this.x+3*this.cellSize,this.y+2*this.cellSize]),t.push([this.x+4*this.cellSize,this.y+this.cellSize]),t.push([this.x+5*this.cellSize,this.y+2*this.cellSize]),t.push([this.x+4*this.cellSize,this.y+3*this.cellSize]),t.push([this.x+3*this.cellSize,this.y+4*this.cellSize]),t.push([this.x+2*this.cellSize,this.y+3*this.cellSize]),t.push([this.x+1*this.cellSize,this.y+2*this.cellSize]),t.push([this.x+0*this.cellSize,this.y+1*this.cellSize]),t}getMOutlineLineSegments(){let t=new Array;return t.push(new b(this.x+this.cellSize,this.y,this.x+3*this.cellSize,this.y+2*this.cellSize)),t.push(new b(this.x+3*this.cellSize,this.y+2*this.cellSize,this.x+5*this.cellSize,this.y)),t.push(new b(this.x+5*this.cellSize,this.y,this.x+6*this.cellSize,this.y+this.cellSize)),t.push(new b(this.x+6*this.cellSize,this.y+this.cellSize,this.x+6*this.cellSize,this.y+3*this.cellSize)),t.push(new b(this.x+6*this.cellSize,this.y+3*this.cellSize,this.x+5*this.cellSize,this.y+4*this.cellSize)),t.push(new b(this.x+5*this.cellSize,this.y+4*this.cellSize,this.x+4*this.cellSize,this.y+3*this.cellSize)),t.push(new b(this.x+4*this.cellSize,this.y+3*this.cellSize,this.x+3*this.cellSize,this.y+4*this.cellSize)),t.push(new b(this.x+3*this.cellSize,this.y+4*this.cellSize,this.x+2*this.cellSize,this.y+3*this.cellSize)),t.push(new b(this.x+2*this.cellSize,this.y+3*this.cellSize,this.x+this.cellSize,this.y+4*this.cellSize)),t.push(new b(this.x+this.cellSize,this.y+4*this.cellSize,this.x,this.y+3*this.cellSize)),t.push(new b(this.x,this.y+3*this.cellSize,this.x,this.y+this.cellSize)),t.push(new b(this.x,this.y+this.cellSize,this.x+this.cellSize,this.y)),t}getMOutlinePoints(){let t=new Array;return t.push([this.x,this.y+this.cellSize]),t.push([this.x+this.cellSize,this.y]),t.push([this.x+2*this.cellSize,this.y+this.cellSize]),t.push([this.x+3*this.cellSize,this.y+2*this.cellSize]),t.push([this.x+4*this.cellSize,this.y+this.cellSize]),t.push([this.x+5*this.cellSize,this.y]),t.push([this.x+6*this.cellSize,this.y+this.cellSize]),t.push([this.x+6*this.cellSize,this.y+2*this.cellSize]),t.push([this.x+6*this.cellSize,this.y+3*this.cellSize]),t.push([this.x+5*this.cellSize,this.y+4*this.cellSize]),t.push([this.x+4*this.cellSize,this.y+3*this.cellSize]),t.push([this.x+3*this.cellSize,this.y+4*this.cellSize]),t.push([this.x+2*this.cellSize,this.y+3*this.cellSize]),t.push([this.x+1*this.cellSize,this.y+4*this.cellSize]),t.push([this.x+0*this.cellSize,this.y+3*this.cellSize]),t.push([this.x+0*this.cellSize,this.y+2*this.cellSize]),t.push([this.x+0*this.cellSize,this.y+1*this.cellSize]),t}static setRandomColors(t,e=!0,i=!0){for(const s of t){const t=f.getRandomOriginalColor();s.fillColor=t,s.startFillColor=t,s.endFillColor=t,s.strokeColor=t,s.isFillVisible=e,s.isStrokeVisible=i}}static setColors(t,e,i,s=!0,r=!0){for(const l of t)l.fillColor=e,l.startFillColor=e,l.endFillColor=e,l.strokeColor=i,l.isFillVisible=s,l.isStrokeVisible=r}static createMakeabilityLabLogoCellArray(t,e,i){let s=new Array(u.numRows);for(let t=0;t<s.length;t++)s[t]=new Array(u.numCols);return s[0]=u.createMakeabilityLabTopRow(t,e,i),e+=i,s[1]=u.createMakeabilityLab2ndRow(t,e,i),e+=i,s[2]=u.createMakeabilityLab3rdRow(t,e,i),e+=i,s[3]=u.createMakeabilityLabBottomRow(t,e,i),s}static createMakeabilityLabTopRow(t,e,i){let s=new Array(u.numCols),r=0;return s[r++]=y.createCellWithBottomTriangleOnly(t,e,i,d.BottomRight),t+=i,s[r++]=y.createCellWithBottomTriangleOnly(t,e,i,d.BottomLeft),t+=i,s[r++]=y.createEmptyCell(t,e,i,d.TopLeft),t+=i,s[r++]=y.createEmptyCell(t,e,i,d.TopRight),t+=i,s[r++]=y.createCellWithBottomTriangleOnly(t,e,i,d.BottomRight),t+=i,s[r++]=y.createCellWithBottomTriangleOnly(t,e,i,d.BottomLeft),s}static createMakeabilityLab2ndRow(t,e,i){let s=new Array(u.numCols),r=0;return s[r++]=y.createCell(t,e,i,d.TopRight,d.BottomLeft),t+=i,s[r++]=y.createCell(t,e,i,d.TopLeft,d.BottomRight),t+=i,s[r++]=y.createCellWithBottomTriangleOnly(t,e,i,d.BottomLeft),t+=i,s[r++]=y.createCellWithBottomTriangleOnly(t,e,i,d.BottomRight),t+=i,s[r++]=y.createCell(t,e,i,d.TopRight,d.BottomLeft),t+=i,s[r++]=y.createCell(t,e,i,d.TopLeft,d.BottomRight),s}static createMakeabilityLab3rdRow(t,e,i){let s=new Array(u.numCols);for(let r=0;r<s.length;r++){let l=d.TopLeft;r%2!=0&&(l=d.TopRight),s[r]=y.createCell(t,e,i,l),t+=i}return s}static createMakeabilityLabBottomRow(t,e,i){let s=new Array(u.numCols);for(let r=0;r<s.length;r++){let l=d.TopRight;r%2!=0&&(l=d.TopLeft),s[r]=y.createCellWithTopTriangleOnly(t,e,i,l),t+=i}return s}static isMShadowTriangle(t,e,i){return 2==t&&1==e&&2==i||3==t&&1==e&&1==i||2==t&&4==e&&2==i||3==t&&4==e&&1==i}static isLTriangle(t,e,i){return 0==t&&0==e&&2==i||0==t&&1==e&&2==i||1==t&&0==e&&1==i||1==t&&1==e&&1==i||1==t&&1==e&&2==i||1==t&&2==e&&2==i||2==t&&1==e&&1==i||2==t&&2==e&&1==i||2==t&&2==e&&2==i||3==t&&2==e&&1==i||3==t&&3==e&&1==i||2==t&&3==e&&1==i||2==t&&3==e&&2==i||1==t&&3==e&&2==i||2==t&&4==e&&1==i||1==t&&4==e&&2==i}}const d={TopLeft:"TopLeft",TopRight:"TopRight",BottomLeft:"BottomLeft",BottomRight:"BottomRight"};class y{constructor(t,e){this.tri1=t,this.tri2=e,this.drawBoundingBox=!1}setDrawDebugInfo(t){this.drawBoundingBox=t,this.tri1.setDrawDebugInfo(t),this.tri2.setDrawDebugInfo(t)}get x(){return this.tri1.x}set x(t){this.tri1.x=t,this.tri2.x=t}get y(){return this.tri1.y}set y(t){this.tri1.y=t,this.tri2.y=t}get size(){return this.tri1.size}set size(t){this.tri1.size=t,this.tri2.size=t}setColors(t,e){this.setFillColor(t),e?this.setStrokeColor(e):this.setStrokeColor(t)}setFillColor(t){this.tri1.fillColor=t,this.tri2.fillColor=t}setStrokeWidth(t){this.tri1.strokeWidth=t,this.tri2.strokeWidth=t}setStrokeColor(t){this.tri1.strokeColor=t,this.tri2.strokeColor=t}setVisibility(t){this.tri1.visible=t,this.tri2.visible=t}getBoundingBox(){const t=this.tri1.visible?this.tri1.getBoundingBox():null,e=this.tri2.visible?this.tri2.getBoundingBox():null;if(t&&e){const i=Math.min(t.x,e.x),s=Math.min(t.y,e.y);return{x:i,y:s,width:Math.max(t.x+t.width,e.x+e.width)-i,height:Math.max(t.y+t.height,e.y+e.height)-s}}return t||e||{x:0,y:0,width:0,height:0}}draw(t){if(this.tri1.visible&&this.tri1.draw(t),this.tri2.visible&&this.tri2.draw(t),t.save(),this.drawBoundingBox){const e=this.getBoundingBox();t.setLineDash([3,4]),t.strokeStyle="rgba(0, 0, 240, 0.5)",t.strokeRect(e.x,e.y,e.width,e.height)}t.restore()}static createEmptyCell(t,e,i,s=d.TopLeft){let r=new m(t,e,i,s),l=new m(t,e,i,m.getOppositeDirection(s));return r.visible=!1,l.visible=!1,new y(r,l)}static createCellWithTopTriangleOnly(t,e,i,s){let r=new m(t,e,i,s),l=new m(t,e,i,m.getOppositeDirection(s));return l.visible=!1,new y(r,l)}static createCellWithBottomTriangleOnly(t,e,i,s){let r=new m(t,e,i,m.getOppositeDirection(s)),l=new m(t,e,i,s);return r.visible=!1,new y(r,l)}static createCell(t,e,i,s,r){let l=new m(t,e,i,s);r||(r=m.getOppositeDirection(s));let o=new m(t,e,i,r);return new y(l,o)}}class m{constructor(t,e,i,s,r="white",l="black",o=1,a=!0){this.x=t,this.y=e,this.size=i,this.direction=s,this.angle=0,this.strokeColor=l,this.fillColor=r,this.strokeWidth=o,this.visible=a,this.isFillVisible=!0,this.isStrokeVisible=!0,this.drawCellOutline=!1,this.drawBoundingBox=!1}setDrawDebugInfo(t){this.drawCellOutline=t,this.drawBoundingBox=t}setColors(t,e){this.fillColor=t,this.strokeColor=e||t}draw(t){if(this.visible){switch(t.save(),this.isFillVisible&&this.fillColor&&(t.fillStyle=this.fillColor),this.isStrokeVisible&&this.strokeColor&&this.strokeWidth>0&&(t.strokeStyle=this.strokeColor,t.lineWidth=this.strokeWidth),t.translate(this.x,this.y),t.rotate(this.angle*Math.PI/180),t.beginPath(),this.direction){case d.BottomLeft:t.moveTo(0,0),t.lineTo(0,this.size),t.lineTo(this.size,this.size);break;case d.BottomRight:t.moveTo(0,this.size),t.lineTo(this.size,this.size),t.lineTo(this.size,0);break;case d.TopRight:t.moveTo(0,0),t.lineTo(this.size,0),t.lineTo(this.size,this.size);break;case d.TopLeft:default:t.moveTo(0,this.size),t.lineTo(0,0),t.lineTo(this.size,0)}if(t.closePath(),this.isFillVisible&&this.fillColor&&t.fill(),this.isStrokeVisible&&this.strokeColor&&this.strokeWidth>0&&t.stroke(),this.drawCellOutline&&(t.setLineDash([2,3]),t.strokeStyle="rgba(0, 200, 0, 0.5)",t.strokeRect(0,0,this.size,this.size)),t.restore(),t.save(),this.drawBoundingBox){const e=this.getBoundingBox();t.setLineDash([1,5]),t.strokeStyle="rgba(200, 0, 30, 0.8)",t.strokeRect(e.x,e.y,e.width,e.height)}t.restore()}}getBoundingBox(){const t=this.angle*Math.PI/180;let e;switch(this.direction){case d.BottomLeft:e=[{x:0,y:0},{x:0,y:this.size},{x:this.size,y:this.size}];break;case d.BottomRight:e=[{x:0,y:this.size},{x:this.size,y:this.size},{x:this.size,y:0}];break;case d.TopRight:e=[{x:0,y:0},{x:this.size,y:0},{x:this.size,y:this.size}];break;case d.TopLeft:default:e=[{x:0,y:this.size},{x:0,y:0},{x:this.size,y:0}]}const i=e.map((e=>{const i=e.x*Math.cos(t)-e.y*Math.sin(t),s=e.x*Math.sin(t)+e.y*Math.cos(t);return{x:this.x+i,y:this.y+s}})),s=Math.min(...i.map((t=>t.x))),r=Math.max(...i.map((t=>t.x))),l=Math.min(...i.map((t=>t.y)));return{x:s,y:l,width:r-s,height:Math.max(...i.map((t=>t.y)))-l}}static getOppositeDirection(t){switch(t){case d.BottomLeft:return d.TopRight;case d.BottomRight:return d.TopLeft;case d.TopRight:return d.BottomLeft;case d.TopLeft:default:return d.BottomRight}}static createTriangle(t){return new m(t.x,t.y,t.size,t.direction,t.fillColor,t.strokeColor,t.strokeWeight,t.visible)}}class p{constructor(t,e,i,s="rgba(200, 200, 200, 0.5)",r=null,l=0,o=0){this.gridArray=p.createGrid(t,e,i,s,r,l,o),this.visible=!0,this.setFillColor(r)}draw(t){if(this.visible)for(let e=0;e<this.gridArray.length;e++)for(let i=0;i<this.gridArray[e].length;i++)this.gridArray[e][i].draw(t)}setStrokeColor(t){for(let e=0;e<this.gridArray.length;e++)for(let i=0;i<this.gridArray[e].length;i++)this.gridArray[e][i].tri1.strokeColor=t,this.gridArray[e][i].tri2.strokeColor=t}setFillColor(t){for(let e=0;e<this.gridArray.length;e++)for(let i=0;i<this.gridArray[e].length;i++)this.gridArray[e][i].tri1.fillColor=t,this.gridArray[e][i].tri2.fillColor=t}static createGrid(t,e,i,s,r,l=0,o=0){const a=l-Math.ceil(l/i)*i,h=o-Math.ceil(o/i)*i,n=Math.ceil((t-a)/i),g=Math.ceil((e-h)/i);let c=new Array(g);for(let t=0;t<c.length;t++){c[t]=new Array(n);for(let e=0;e<c[t].length;e++){const n=a+e*i,g=h+t*i,b=Math.round((n-l)/i),u=Math.round((g-o)/i),m=u%2==0&&b%2==0||u%2!=0&&b%2!=0?d.TopRight:d.TopLeft,p=y.createCell(n,g,i,m);p.tri1.strokeColor=s,p.tri2.strokeColor=s,r&&(p.tri1.fillColor=r,p.tri2.fillColor=r),c[t][e]=p}}return c}}const L={Blue:"rgb(135, 202, 228)",BlueGray:"rgb(147, 169, 207)",Purple:"rgb(171, 147, 197)",Green:"rgb(148, 206, 146)",Orange:"rgb(235, 185, 130)",RedPurple:"rgb(207, 145, 166)",Pink:"rgb(237, 162, 163)",YellowGreen:"rgb(239, 226, 127)",LightGreen:"rgb(209, 226, 133)",BlueGreen:"rgb(147, 211, 202)"},x=[L.Blue,L.BlueGray,L.YellowGreen,L.Purple,L.Green,L.Orange,L.YellowGreen,L.LightGreen,L.Orange,L.RedPurple,L.BlueGreen,L.Pink];class f{static getRandomOriginalColor(){return f.getRandomColorFromPalette(L)}static getRandomColorFromPalette(t){t||(t=L);const e=Object.keys(t);return t[e[Math.floor(Math.random()*e.length)]]}}function k(t){let e=t.length;for(;0!==e;){const i=Math.floor(Math.random()*e);e--,[t[e],t[i]]=[t[i],t[e]]}return t}class w{constructor(t,e,i,s="rgb(255, 255, 255, 0.5)",r="rgba(0, 0, 0, 0.6)"){this.makeLabLogo=new u(t,e,i),this.makeLabLogo.visible=!1,this.makeLabLogoAnimated=new u(t,e,i),this.makeLabLogoAnimated.isLOutlineVisible=!1,this.makeLabLogoAnimated.isMOutlineVisible=!1,this.makeLabLogoAnimated.isLabelVisible=!0,this.makeLabLogo.setLTriangleStrokeColor("rgb(240, 240, 240)"),this.makeLabLogoAnimated.areLTriangleStrokesVisible=!0,this.makeLabLogo.isLabelVisible=!0,this._animTris=[],this._artMessage=null,this._artMessageColor=null,this._artMessageFontSize=null,this.explodeX=!0,this.explodeY=!0,this.explodeSize=!0,this.explodeAngle=!0,this.explodeFillColor=!0,this.explodeStrokeColor=!0,this.explodeStrokeWidth=!0,this.startFillColor=s,this.startStrokeColor=r,this.easingFunction=l,this.lOutlineAppearThreshold=.85,this.labelAppearThreshold=.7,this.labelSlideDistanceFraction=.4,this._currentLerpAmt=0}get finalWidth(){return this.makeLabLogo.width}get finalHeight(){return this.makeLabLogo.height}fitToCanvas(t,e,i=!1){this.makeLabLogo.fitToCanvas(t,e,i),this.makeLabLogoAnimated.fitToCanvas(t,e,i)}setLogoSize(t){this.makeLabLogo.setLogoSize(t),this.makeLabLogoAnimated.setLogoSize(t)}setLogoSizeEndState(t){this.makeLabLogo.setLogoSize(t)}setXPosition(t){this.makeLabLogo.x=t,this.makeLabLogoAnimated.x=t}setYPosition(t){this.makeLabLogo.y=t,this.makeLabLogoAnimated.y=t}setLogoPosition(t,e){this.makeLabLogo.setLogoPosition(t,e),this.makeLabLogoAnimated.setLogoPosition(t,e)}centerLogo(t,e,i=!1){this.makeLabLogo.centerLogo(t,e,i),this.makeLabLogoAnimated.centerLogo(t,e,i)}reset(t,e){this._artMessage=null,this._artMessageColor=null;const i=this.makeLabLogo.getAllTriangles().filter((t=>t.visible)),r=this.makeLabLogoAnimated.getAllTriangles().filter((t=>t.visible)),l=this.makeLabLogo.cellSize;r.forEach((t=>t.setColors(this.startFillColor,this.startStrokeColor))),this._animTris=r.map(((r,o)=>{const a=i[o],h=this.explodeSize?s(l/2,3*l):l;return r.x=this.explodeX?s(h,t-h):a.x,r.y=this.explodeY?s(h,e-h):a.y,r.angle=this.explodeAngle?s(0,540):0,r.size=h,r.fillColor=this.explodeFillColor?r.fillColor:a.fillColor,r.strokeColor=this.explodeStrokeColor?r.strokeColor:a.strokeColor,r.strokeWidth=this.explodeStrokeWidth?r.strokeWidth:a.strokeWidth,r._start=S(r),r._dest=S(a,0),r}))}resetFromArt(t,e,i){this._artMessage=t.message??null,this._artMessageColor=t.messageColor??"#000000",this._artMessageFontSize=.7*t.triangleSize;const r=this.makeLabLogo.cellSize,l=this.makeLabLogo.getBoundingBox(),o=t.getAllTriangles(),a=function(t){const e=new Map;for(const i of t)e.has(i.direction)||e.set(i.direction,[]),e.get(i.direction).push(i);return e}(this.makeLabLogo.getAllTriangles().filter((t=>t.visible)));for(const t of a.values())k(t);const h=new Map,n=this._animTris.length===o.length;this._animTris=o.map(((t,e)=>{const i=n?this._animTris[e]:m.createTriangle(t);i.x=t.x,i.y=t.y,i.size=t.size??r,i.angle=0,i.fillColor=t.fillColor,i.strokeColor=t.strokeColor,i.strokeWidth=t.strokeWidth??1,i.direction=t.direction,i.visible=!0,i._start=S(i);const o=a.get(t.direction);if(o&&o.length>0){const e=(h.get(t.direction)??0)%o.length;h.set(t.direction,e+1),i._dest=S(o[e])}else i._dest={x:s(l.x,l.x+l.width),y:s(l.y,l.y+l.height),size:r,angle:0,fillColor:this.startFillColor,strokeColor:this.startStrokeColor,strokeWidth:1};return i}))}update(t){if(0===this._animTris.length)return;this._currentLerpAmt=t;const e=this.easingFunction(t);if(t>=this.lOutlineAppearThreshold){this.makeLabLogoAnimated.isLOutlineVisible=!0;const e=(t-this.lOutlineAppearThreshold)/(1-this.lOutlineAppearThreshold);this.makeLabLogoAnimated.lOutlineOpacity=this.easingFunction(Math.min(e,1))}else this.makeLabLogoAnimated.isLOutlineVisible=!1,this.makeLabLogoAnimated.lOutlineOpacity=0;if(t>=1)for(const t of this._animTris)t.visible=!1;else for(const s of this._animTris){s.visible=!0;const r=s._start,l=s._dest;s.x=i(r.x,l.x,e),s.y=i(r.y,l.y,e),s.size=i(r.size,l.size,e),s.angle=i(r.angle,l.angle,e),s.strokeWidth=i(r.strokeWidth,l.strokeWidth,t),s.fillColor=a(r.fillColor,l.fillColor,t),s.strokeColor=a(r.strokeColor,l.strokeColor,t)}}draw(t){const e=this._currentLerpAmt??0;if(this.makeLabLogo.draw(t),e>=1){const e=this.makeLabLogo.visible;this.makeLabLogo.visible=!0,this.makeLabLogo.draw(t),this.makeLabLogo.visible=e}else for(const e of this._animTris)e.draw(t);this.makeLabLogoAnimated.isLOutlineVisible&&this.makeLabLogoAnimated.drawLOutline(t),this._artMessage&&this._drawArtMessage(t,e),this.makeLabLogoAnimated.isLabelVisible&&this._drawAnimatedLabel(t,e)}_drawArtMessage(t,e){const i=Math.max(0,1-1.1*e);if(i<=0)return;let s=1/0;for(const t of this._animTris)if(t.visible){const e=t.y-t.size/2;e<s&&(s=e)}const r=this.makeLabLogo.getBoundingBox(),l=Math.min(s,r.y),o=.4*this._artMessageFontSize,a=r.x+r.width/2,h=l-o;t.save(),t.globalAlpha=i,t.font=`bold ${this._artMessageFontSize}px sans-serif`,t.fillStyle=this._artMessageColor,t.textAlign="center",t.textBaseline="alphabetic",t.fillText(this._artMessage,a,h),t.restore()}_drawAnimatedLabel(t,e){if(e<=this.labelAppearThreshold)return;const i=(e-this.labelAppearThreshold)/(1-this.labelAppearThreshold),s=this.easingFunction(Math.min(i,1)),r=this.makeLabLogoAnimated.labelFontSize*this.labelSlideDistanceFraction*(1-s);this.makeLabLogoAnimated.drawLabel(t,{opacity:s,yOffset:r})}}function S(t,e){return{x:t.x,y:t.y,size:t.size,angle:void 0!==e?e:t.angle,fillColor:t.fillColor,strokeColor:t.strokeColor,strokeWidth:t.strokeWidth??1}}class A{constructor(t,e,i,s){this.data=s,this.triangleSize=i,this.artArray=A._buildGrid(t,e,i,s),this.visible=!0,this.showMessage=!0,this.messageColor=s.messageColor??A._defaultMessageColor(s),console.log("Initialized TriangleArt with name: ",this.name),console.log("Message: ",this.message)}static numCols(t){return t.numCols}static numRows(t){return t.numRows}get x(){return this.artArray[0][0].x}get y(){return this.artArray[0][0].y}get cellSize(){return this.artArray[0][0].size}get numRows(){return this.data.numRows}get numCols(){return this.data.numCols}get width(){return this.numCols*this.triangleSize}get height(){return this.numRows*this.triangleSize}get name(){return this.data.name??""}get message(){return this.data.message??""}getAllTriangles(t=!0){const e=[];for(const i of this.artArray)for(const s of i)t&&!s.tri1.visible||e.push(s.tri1),t&&!s.tri2.visible||e.push(s.tri2);return e}setStrokeTransparent(t){for(const e of this.getAllTriangles())e.isStrokeVisible=!t}setFillTransparent(t){for(const e of this.getAllTriangles())e.isFillVisible=!t}setColors(t,e){for(const i of this.artArray)for(const s of i)s.setFillColor(t),s.setStrokeColor(e)}setStrokeColors(t){for(const e of this.artArray)for(const i of e)i.setStrokeColor(t)}draw(t){if(this.visible){this.showMessage&&this.message?(this.drawMessage(t),console.log("Drawing message: ",this.message)):console.log("Message hidden or empty, skipping drawMessage.");for(const e of this.artArray)for(const i of e)i.draw(t)}}drawMessage(t,e=1,i=null,s=null){if(!this.message)return;const r=Math.round(.7*this.triangleSize),l=i??this.x+this.width/2,o=s??this.y-r;t.save(),t.globalAlpha=Math.max(0,Math.min(1,e)),t.font=`bold ${r}px sans-serif`,t.fillStyle=this.messageColor,t.textAlign="center",t.textBaseline="alphabetic",t.fillText(this.message,l,o),t.restore()}static async fromURL(t,e,i,s){const r=await fetch(t);if(!r.ok)throw new Error(`Failed to load ${t}: ${r.status}`);const l=await r.json();return new A(e,i,s,l)}static async loadData(t){const e=await fetch(t);if(!e.ok)throw new Error(`Failed to load ${t}: ${e.status}`);return e.json()}static _buildGrid(t,e,i,s){const{palette:r,grid:l,directionPattern:o}=s,a=[];let h=e;for(let e=0;e<l.length;e++){const s=l[e],n=Array.isArray(s)?s:s.cells,g=[];let c=t;for(let t=0;t<n.length;t++){const s=n[t];g.push(A._buildCell(c,h,i,e,t,s,r,o)),c+=i}a.push(g),h+=i}return a}static _buildCell(t,e,i,s,r,l,o,a){if(null==l)return y.createEmptyCell(t,e,i);let h,n;if(h="string"==typeof l?{t1:l,t2:l}:Array.isArray(l)?{t1:l[0],t2:l[1]}:{...l},h.tHalf&&(h.t1=h.tHalf,h.t2=null),h.dir){if(n=d[h.dir],!n)throw new Error(`Unknown direction "${h.dir}" at row ${s}, col ${r}`)}else n=A._getDefaultDirection(s,r,a);const g=y.createCell(t,e,i,n);return A._applyTriProps(g.tri1,h.t1,h.t1Visible,o),A._applyTriProps(g.tri2,h.t2,h.t2Visible,o),g}static _getDefaultDirection(t,e,i){return"alternating"===i?(t+e)%2==0?d.TopLeft:d.TopRight:d.TopLeft}static _applyTriProps(t,e,i,s){if(t.visible=!1!==i&&null!=e,null!=e){const i=A._resolveColor(e,s);t.setColors(i)}}static _resolveColor(t,e){const i=e[t];if(!i)return t;const s=i.base;return i.jitter?A._applyJitter(s,i.jitter):s}static _applyJitter(t,e){switch(e.type){case"brightness":return function(t,e){const i=h(t),s=g(i.r,i.g,i.b);s.v=e/100;const r=n(s.h,s.s,s.v);return`rgba(${r.r}, ${r.g}, ${r.b}, ${i.a??1})`}(t,A._sampleValue(e));case"saturation+brightness":return function(t,e,i){const s=h(t),r=g(s.r,s.g,s.b);r.s=e/100,r.v=i/100;const l=n(r.h,r.s,r.v);return`rgba(${l.r}, ${l.g}, ${l.b}, ${s.a??1})`}(t,s(e.saturation[0],e.saturation[1]),A._sampleBrightnessFromCompound(e));default:return console.warn(`Unknown jitter type: "${e.type}", using base color`),t}}static _sampleValue(t){return"gaussian"===t.distribution?r(t.mean,t.sd):s(t.range[0],t.range[1])}static _sampleBrightnessFromCompound(t){return"gaussian"===t.brightnessDistribution?r(t.brightnessMean??99,t.brightnessSd??1):s(t.brightness[0],t.brightness[1])}static _defaultMessageColor(t){const e=Object.keys(t.palette??{});return e.length>0?t.palette[e[0]].base:"#000000"}}export{y as Cell,p as Grid,b as LineSegment,u as MakeabilityLabLogo,f as MakeabilityLabLogoColorer,w as MakeabilityLabLogoMorpher,x as ORIGINAL_COLOR_ARRAY,L as OriginalColorPaletteRGB,m as Triangle,A as TriangleArt,d as TriangleDir,o as Vector,h as convertColorStringToObject,e as convertToDegrees,t as convertToRadians,i as lerp,a as lerpColor,s as random,k as shuffle};
